/*
SSlider
Author: Kadymov Alexander (alkadymov@gmail.com)
https://github.com/kadymov/sslider
*/
(function(d,l,p,q){function m(a,c){this.element=a;c=Array.isArray(c)?{images:c}:c;this.options=d.extend({},n,c);this.init()}var n={images:[],animationSpeed:300,afterSlideChange:function(a,c){},swipeDurationThreshold:200,swipeDistanceThreshold:30};d.extend(m.prototype,{init:function(){var a=d('<div class="ss-slider-container" style="position: relative; overflow: hidden;" />'),c=d('<div class="ss-slider-trolley" style="position: absolute; height: 100%; left: 0;" />').appendTo(a),b=c[0].style;this._elements=
{$container:a,$trolley:c};this._currentSlideId=0;this._slides=[];this._createSlides();this._resize();this._loadImage(this.options.images[0],this._slides[0]);var f=!1,e,h,k,g=!1;a.on("vmousedown",function(a){this._startDrag();e=a.pageX;h=a.pageY;f=!0;k=parseInt(c.css("left"),10);g=!1}.bind(this));a.on("vmousemove",function(a){if(f){if(!g){if(Math.abs(e-a.pageX)<Math.abs(h-a.pageY)){f=!1;return}g=!0}a.preventDefault();this._drag(k,e-a.pageX,b)}}.bind(this));a.on("vmouseup",function(a){f&&(f=!1,this._endDrag(e-
    a.pageX))}.bind(this));d(l).on("resize",this._resize.bind(this));d(l).on("orientationchange",this._resize.bind(this));d(this.element).append(a)},load:function(a){this.options.images=a;this._createSlides();this._loadImage(this.options.images[0],this._slides[0])},next:function(){this._setActSlidesPos(!0);this._goto(1)},prev:function(){this._setActSlidesPos(!0);this._goto(-1)},destroy:function(){d.data(this,"sslider",null);this._elements.$container.remove()},_goto:function(a){var c=this._elements.$container.width(),
    b=-c,f=this._currentSlideId,e=this._slides,d=f+1>=e.length?0:f+1,k=0>f-1?e.length-1:f-1,g=f;0>a?(b=0,g=this._currentSlideId=k):0<a&&(b=2*-c,g=this._currentSlideId=d);e[g].is(".loaded")||this._loadImage(this.options.images[g],e[g]);this._elements.$trolley.animate({left:b},this.options.animationSpeed,null,function(){e[k].hide();e[d].hide();e[f].hide();e[this._currentSlideId].show()}.bind(this));this.options.afterSlideChange(g,this.options.images[g])},_createSlides:function(){var a=this._elements.$trolley,
    c=this._slides=[],b;a.empty();for(var f=0,e=this.options.images.length;f<e;f++)b=d('<div class="ss-slider-slide" style="position: absolute; display: none;"><i class="ss-loader"></i></div>').appendTo(a),c.push(b)},_resize:function(){var a=d(this.element).width(),c=d(l).height(),b=this._elements;b.$container.css("height",c);b.$trolley.css({width:3*a,left:-a});this._slides.forEach(function(b){b.css({width:a,height:"100%"})});this._setActSlidesPos()},_loadImage:function(a,c){var b=new Image;b.onload=
    function(){c.addClass("loaded").empty().append(b);d(b).fadeIn(300)};b.className="ss-slider-image";b.style.display="none";b.ondragstart="return false;";b.src=a;return b},_setActSlidesPos:function(a){var c=this._currentSlideId,b=this._slides,d=c+1>=b.length?0:c+1,e=0>c-1?b.length-1:c-1,h=this._elements.$container.width();this._elements.$trolley.stop();this._elements.$trolley.css("left",-h);b[c].css({left:h,display:"block"});b[d].css({left:2*h,display:a?"block":"none"});b[e].css({left:0,display:a?"block":
    "none"})},_startDrag:function(){this._setActSlidesPos(!0);this._startDragTime=new Date},_drag:function(a,c,b){b.left=a-c+"px"},_endDrag:function(a){var c=this._elements.$container.width(),b=new Date-this._startDragTime;Math.abs(a)>c/2||b<this.options.swipeDurationThreshold&&Math.abs(a)>this.options.swipeDistanceThreshold?this._goto(a):this._goto(0)}});d.fn.sslider=function(a){return this.each(function(){d.data(this,"sslider")||d.data(this,"sslider",new m(this,a))})}})(jQuery,window,document);